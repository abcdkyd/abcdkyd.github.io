<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8" />

    

    

    <title>php设计模式 | Jxie的个人博客</title>
    <meta name="author" content="Jxie" />
    <meta name="version" content="1.0.0" />
    <meta name="keywords" content="" />
    <meta name="description" content="适配器模式适配器设计模式只是将某个对象的接口适配为另外一个对象所期望的接口当添加新功能时，功能要求采用不同的方式使用现有的对象，而不是采用远行设计的方式，可以采用适配器模式构建另一个对象的方案。同时，适配器设计模式也是针对数据源改变的优秀解决方案，常见有改变数据库引擎和第三方提供数据格式变化关系说明MyObject类包含一个名为 methodA()的公共方法。OriginalConsumer类获取MyObject的一个实例，并且在执行其doSomthing()函数期间调用m..." />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=no" />

    
    <link rel="alternate" href="/atom.xml" title="Jxie的个人博客" type="application/atom+xml">
    
    
    <link rel="icon" href="/images/favicon.ico">
    

    <link rel="stylesheet" href="/css/style.css">
</head>
<body>

    <main class="app">
        <header class="header clearfix">
    <div id="nav" class="nav">
    <div class="nav-mobile">
        <button id="open-panel" class="open-panel nav-mobile-item"><i class="icon-documents"></i></button>
        <h1 class="nav-mobile-title nav-mobile-item">Jxie的个人博客</h1>
        <button id="open-menus" class="open-panel nav-mobile-item"><i class="icon-library"></i></button>
    </div>

    <nav id="nav-inner" class="nav-inner">
        
            <a class="nav-item" href="/">
                <span class="nav-text">首页</span>
            </a>
        
            <a class="nav-item" href="/categories">
                <span class="nav-text">分类</span>
            </a>
        
            <a class="nav-item" href="/tags">
                <span class="nav-text">标签</span>
            </a>
        
            <a class="nav-item" href="/archives">
                <span class="nav-text">归档</span>
            </a>
        
            <a class="nav-item" href="/atom.xml">
                <span class="nav-text">订阅</span>
            </a>
        
    </nav>
</div>

    <aside id="aside" class="aside">
    <div id="aside-mask" class="aside-mask"></div>
    <div id="aside-inner" class="aside-inner">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit"><i class="icon-search-stroke"></i></button><input type="hidden" name="sitesearch" value="https://abcdkyd.github.io"></form>

        
        
        
        

        
        <ol class="toc"><li class="toc-item toc-level-3"><a class="toc-link" href="#适配器模式"><span class="toc-number">1.</span> <span class="toc-text">适配器模式</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#关系说明"><span class="toc-number">1.1.</span> <span class="toc-text">关系说明</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#代码示例"><span class="toc-number">1.2.</span> <span class="toc-text">代码示例</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#建造者模式"><span class="toc-number">2.</span> <span class="toc-text">建造者模式</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#关系说明-v2"><span class="toc-number">2.1.</span> <span class="toc-text">关系说明</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#代码示例-v2"><span class="toc-number">2.2.</span> <span class="toc-text">代码示例</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#数据访问对象模式"><span class="toc-number">3.</span> <span class="toc-text">数据访问对象模式</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#代码示例-v3"><span class="toc-number">3.1.</span> <span class="toc-text">代码示例</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#装饰器模式"><span class="toc-number">4.</span> <span class="toc-text">装饰器模式</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#关系说明-v3"><span class="toc-number">4.1.</span> <span class="toc-text">关系说明</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#代码示例-v4"><span class="toc-number">4.2.</span> <span class="toc-text">代码示例</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#委托模式"><span class="toc-number">5.</span> <span class="toc-text">委托模式</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#关系说明-v4"><span class="toc-number">5.1.</span> <span class="toc-text">关系说明</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#代码示例-v5"><span class="toc-number">5.2.</span> <span class="toc-text">代码示例</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#外观模式"><span class="toc-number">6.</span> <span class="toc-text">外观模式</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#关系说明-v5"><span class="toc-number">6.1.</span> <span class="toc-text">关系说明</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#代码示例-v6"><span class="toc-number">6.2.</span> <span class="toc-text">代码示例</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#工厂模式"><span class="toc-number">7.</span> <span class="toc-text">工厂模式</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#关系说明-v6"><span class="toc-number">7.1.</span> <span class="toc-text">关系说明</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#代码示例-v7"><span class="toc-number">7.2.</span> <span class="toc-text">代码示例</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#解释器模式"><span class="toc-number">8.</span> <span class="toc-text">解释器模式</span></a></li></ol>
        
    </div>
</aside>

</header>

        <div id="content" class="content"><article class="article" itemscope itemprop="blogPost">
    
    <header class="article-header">
        
        <h1 itemprop="name">
            php设计模式
        </h1>
        
        <div class="article-meta clearfix">
            <a class="article-date" href="https://abcdkyd.github.io/2018/12/29/php设计模式/index.html">
    
    <i class="icon-calendar"></i>
    
    <time datetime="2018-12-29T14:26:48.000Z" itemprop="datePublished">2018-12-29</time>
</a>

            
<div class="article-tag-list">
    <i class="icon-tag"></i>
    <a class="article-tag-link" href="/tags/php/">php</a>
</div>


        </div>
    </header>
    
    <section class="article-body markdown-body">
        
        <h3 id="适配器模式"><a class="header-anchor" href="#适配器模式"></a>适配器模式</h3>
<blockquote>
<p>适配器设计模式只是将某个对象的接口适配为另外一个对象所期望的接口</p>
</blockquote>
<p>当添加新功能时，功能要求采用不同的方式使用现有的对象，而不是采用远行设计的方式，可以采用适配器模式构建另一个对象的方案。</p>
<p>同时，适配器设计模式也是针对数据源改变的优秀解决方案，常见有<code>改变数据库引擎</code>和<code>第三方提供数据格式变化</code></p>
<h4 id="关系说明"><a class="header-anchor" href="#关系说明"></a>关系说明</h4>
<ol>
<li>MyObject类包含一个名为 methodA()的公共方法。OriginalConsumer类获取MyObject的一个实例，并且在执行其doSomthing()函数期间调用methodA()</li>
<li>引入NewConsumer类。这个类的doSomthing( )函数在执行期间期望调用MyObject实例的一个公共方法: methodB()</li>
<li>通过扩展MyObject类创建MyObjectAdapterForNewConsumer类。像NewConsumer期望的样，新创建的类会提供名为methodB()的公共方法。在这个简单的示例中，所有methodB()都会调用methodA()</li>
</ol>
<a id="more"></a>
<h4 id="代码示例"><a class="header-anchor" href="#代码示例"></a>代码示例</h4>
<ol>
<li>
<p>类适配器模式（类适配器使用的是继承）</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">// 目标角色</span><br><span class="line">interface Target &#123;</span><br><span class="line"> </span><br><span class="line">    // 源类也有的方法1</span><br><span class="line">    public function sampleMethod1();</span><br><span class="line"> </span><br><span class="line">    // 源类没有的方法2</span><br><span class="line">    public function sampleMethod2();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// 源角色</span><br><span class="line">class Adaptee &#123;</span><br><span class="line"></span><br><span class="line">    // 源类含有的方法</span><br><span class="line">    public function sampleMethod1() &#123;</span><br><span class="line">        echo &apos;Adaptee sampleMethod1 &lt;br /&gt;&apos;;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// 类适配器角色</span><br><span class="line">class Adapter extends Adaptee implements Target &#123;</span><br><span class="line"> </span><br><span class="line">    // 源类中没有sampleMethod2方法，在此补充</span><br><span class="line">    public function sampleMethod2() &#123;</span><br><span class="line">        echo &apos;Adapter sampleMethod2 &lt;br /&gt;&apos;;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line">class Client &#123;</span><br><span class="line">    public static function main() &#123;</span><br><span class="line">        $adapter = new Adapter();</span><br><span class="line">        $adapter-&gt;sampleMethod1();</span><br><span class="line">        $adapter-&gt;sampleMethod2();</span><br><span class="line"> </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li>
<p>对象适配器模式（对象适配器使用的是委派）</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line">// 目标角色</span><br><span class="line">interface Target &#123;</span><br><span class="line"> </span><br><span class="line">    // 源类也有的方法1</span><br><span class="line">    public function sampleMethod1();</span><br><span class="line"> </span><br><span class="line">    // 源类没有的方法2</span><br><span class="line">    public function sampleMethod2();</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line">// 源角色</span><br><span class="line">class Adaptee &#123;</span><br><span class="line"> </span><br><span class="line">    // 源类含有的方法</span><br><span class="line">    public function sampleMethod1() &#123;</span><br><span class="line">        echo &apos;Adaptee sampleMethod1 &lt;br /&gt;&apos;;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line">// 类适配器角色</span><br><span class="line">class Adapter implements Target &#123;</span><br><span class="line"> </span><br><span class="line">    private $_adaptee;</span><br><span class="line"> </span><br><span class="line">    public function __construct(Adaptee $adaptee) &#123;</span><br><span class="line">        $this-&gt;_adaptee = $adaptee;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    // 委派调用Adaptee的sampleMethod1方法</span><br><span class="line">    public function sampleMethod1() &#123;</span><br><span class="line">        $this-&gt;_adaptee-&gt;sampleMethod1();</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    // 源类中没有sampleMethod2方法，在此补充</span><br><span class="line">    public function sampleMethod2() &#123;</span><br><span class="line">        echo &apos;Adapter sampleMethod2 &lt;br /&gt;&apos;;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line">class Client &#123;</span><br><span class="line">    public static function main() &#123;</span><br><span class="line">        $adaptee = new Adaptee();</span><br><span class="line">        $adapter = new Adapter($adaptee);</span><br><span class="line">        $adapter-&gt;sampleMethod1();</span><br><span class="line">        $adapter-&gt;sampleMethod2();</span><br><span class="line"> </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ol>
<h3 id="建造者模式"><a class="header-anchor" href="#建造者模式"></a>建造者模式</h3>
<blockquote>
<p>建造者设计模式定义了处理其他对象的复杂构建的对象设计</p>
</blockquote>
<p>通常，复杂性是某个方法内包含的实际逻辑，但当提及一个与对象实例化相关联的复杂对象时，复杂意味着创建这个完整对象所需的步骤等级，建造者设计模式的目的是<code>消除其他对象的复杂创建过程</code>。</p>
<p>建造者模式是一步一步创建一个复杂的对象，它允许用户只通过指定复杂对象的类型和内容就可以构建它们，用户不需要知道内部的具体构建细节，<code>把构建复杂对象的过程封装起来</code>。</p>
<h4 id="关系说明-v2"><a class="header-anchor" href="#关系说明-v2"></a>关系说明</h4>
<ol>
<li>MyObject类具有能够完全实现对象构造的两个方法。为了具有完整的MyObject对象，需要执行complexFunctionA()和complexFunctionB()方法。</li>
<li>MyObjectBuilder类包含一个名为createInstanceOfMyObject()的方法。这个类负责创建MyObject类的一个简单实例。需要注意没有用于进一步构造的配置选项。这个类还存储MyObjectBuilder类创建的实例中的私有实例。</li>
<li>buildMyObject()方法接受参数configurationOptions.这个方法用于调用在MyObjectBuilder对象中存储的MyObject对象的complexFunctionA()和complexFunctionB()方法。</li>
<li>getBuildMyObject()方法返回MyObjectBuilder 对象内部MyObject对象的私有实例，该实例既是完整的，也是正确构建的。</li>
</ol>
<h4 id="代码示例-v2"><a class="header-anchor" href="#代码示例-v2"></a>代码示例</h4>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line">class People&#123;</span><br><span class="line">    public $head;</span><br><span class="line">    public $body;</span><br><span class="line">    </span><br><span class="line">    //不太此类中直接给属性赋值</span><br><span class="line">    function __construct()&#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">//定义具备建造者所需实现的方法</span><br><span class="line">abstract class PeopleBuilder&#123;</span><br><span class="line">    abstract function buildHead();</span><br><span class="line">    abstract function buildBody();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">//具体建造类实现具体业务</span><br><span class="line">class ChildBuilder extends PeopleBuilder&#123;</span><br><span class="line">    private $people;</span><br><span class="line">    function __construct()&#123;</span><br><span class="line">        $this-&gt;people = new people;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    function buildHead()&#123;</span><br><span class="line">       $this-&gt;people-&gt;head = &quot;this is a child&apos;s head!&quot;;</span><br><span class="line">    &#125;</span><br><span class="line">    function buildBody()&#123;</span><br><span class="line">       $this-&gt;people-&gt;body = &quot;this is a child&apos;s body!&quot;;</span><br><span class="line">    &#125;</span><br><span class="line">    function returnResult()&#123;</span><br><span class="line">       return $this-&gt;people;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">class AdultBuilder extends PeopleBuilder&#123;</span><br><span class="line">    private $people;</span><br><span class="line">    function __construct()&#123;</span><br><span class="line">        $this-&gt;people = new people;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    function buildHead()&#123;</span><br><span class="line">       $this-&gt;people-&gt;head =  &quot;this is a adult&apos;s head!&quot;;</span><br><span class="line">    &#125;</span><br><span class="line">    function buildBody()&#123;</span><br><span class="line">       $this-&gt;people-&gt;body =  &quot;this is a adult&apos;s body!&quot;;</span><br><span class="line">    &#125;</span><br><span class="line">    function returnResult()&#123;</span><br><span class="line">       return $this-&gt;people;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">//指挥者，指挥者负责与调用客户端交互，决定创建什么样的产品</span><br><span class="line">class Director&#123;</span><br><span class="line">    function __construct(Peoplebuilder $builder)&#123;</span><br><span class="line">        $builder-&gt;buildHead();</span><br><span class="line">        $builder-&gt;buildBody(); </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">//测试</span><br><span class="line">$builder = new AdultBuilder();  </span><br><span class="line">$director = new Director($builder);  </span><br><span class="line">$person = $builder-&gt;returnResult(); </span><br><span class="line">//this is a adult&apos;s head! this is a adult&apos;s body!</span><br></pre></td></tr></table></figure>
<h3 id="数据访问对象模式"><a class="header-anchor" href="#数据访问对象模式"></a>数据访问对象模式</h3>
<blockquote>
<p>数据访问对象设计模式描述了如何创建提供透明访问任何数据源的对象</p>
</blockquote>
<p>数据访问对象封装了创建SQL调用、减少实例创建的复杂性和重复以及更新进程的智能方式，其编写方式应当是：该对象的使用者不会知道实际使用的表结构和数据库引擎。</p>
<p>管理数据访问对象类中简单性的一个好办法是创建父-子关系。首先，创建一个基本的父对象。这个对象应当负责数据库连接、抽象地执行查询以及与子对象通信。使用数据访问对象设计模式时，最好开始就将一对一关系的子类与数据库中的表相关联。这些子类具有必不可少的信息，如表名和主键。此外，子类可能包含一些特定的公共方法，这些方法通过只对子类有意义的方式执行父类的查询</p>
<h4 id="代码示例-v3"><a class="header-anchor" href="#代码示例-v3"></a>代码示例</h4>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br></pre></td><td class="code"><pre><span class="line">/*</span><br><span class="line">*	MySQL数据库拥有一条记录，该记录包含对每个用户来说都是具体和特有的信息。这种功能性必须允许我们通过用户的主键或对用户名称的查找返回一个用户。此外，我们必须能够对用户实体记录的任意字段执行更新操作。</span><br><span class="line">*	针对此需求，需要使用两个类：第一个类应当是基本数据访问对象类，它具有获取和更新数据方法：</span><br><span class="line">*/</span><br><span class="line"></span><br><span class="line">abstract class baseDAO&#123;</span><br><span class="line">    private $__connection;</span><br><span class="line">    </span><br><span class="line">    public function __construct()&#123;</span><br><span class="line">        $this-&gt;__connectionToDB(DB_USER,DB_PASS,DB_HOST,DB_DATABASE);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    private function __connectToDB($user,$pass,$host,$database)&#123;</span><br><span class="line">        $this-&gt;__connection = mysql_connection($host,$user,$pass);</span><br><span class="line">        mysql_select_db($database,$this-&gt;__connection);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public function fetch($vale,$key = NULL)&#123;</span><br><span class="line">        if(is_null($key))&#123;</span><br><span class="line">            $key = $this-&gt;_primaryKey;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        $sql = &quot;select * from &#123;$this-&gt;_tablename&#125; where &#123;$key&#125; = &apos;&#123;$value&#125;&apos;&quot;;</span><br><span class="line"></span><br><span class="line">        $results = mysql_query($sql,$this-&gt;__connection);</span><br><span class="line"></span><br><span class="line">        $rows = array();</span><br><span class="line"></span><br><span class="line">        while($result = mysql_fetch_array($results))&#123;</span><br><span class="line">            $rows[] = $result;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        return $rows;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    </span><br><span class="line">    public function update($keyedArray)&#123;</span><br><span class="line">        $sql = &quot;update &#123;$this-&gt;_tableName&#125; set &quot;;</span><br><span class="line">        $updates = array();</span><br><span class="line"></span><br><span class="line">        foreach($keyedArray as $column =&gt;$value)&#123;</span><br><span class="line">            $updates[] = &quot;&#123;$column&#125; = &apos;&#123;$value&#125;&apos;&quot;;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        $sql .= implode(&apos;,&apos;,$updates);</span><br><span class="line">        $sql .= &quot; where &#123;$this-&gt;_primaryKey&#125; = &apos;&#123;$keyedArray[$this-&gt;_primaryKey]&#125;&apos;&quot;;</span><br><span class="line"></span><br><span class="line">        mysql_query($sql,$this-&gt;__connection);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">/*</span><br><span class="line">*	这是一个抽象类，为了能够使用该类必须扩展该类。</span><br><span class="line">*	因为很可能会同时打开多个数据库连接，所以在数据访问对象类中存储内部的数据库连接并且每个查询都进行引用是十分重要的。这个数据访问对象类应当唯一地引用自其自己的连接。通常，在更多可拓展的模型中，接口被创建用于共享连接。</span><br><span class="line">*/</span><br><span class="line"></span><br><span class="line">/*</span><br><span class="line">*	任何子类都可以任意扩展这个抽象类：</span><br><span class="line">*/</span><br><span class="line">class UserDAO extends baseDAO&#123;</span><br><span class="line">    protected $_tableName = &quot;userTable&quot;;</span><br><span class="line">    protected $_primaryKey = &apos;id&apos;;</span><br><span class="line"></span><br><span class="line">    public function getUserByFirstName($name)&#123;</span><br><span class="line">        $result = $this-&gt;fetch($name,&apos;firstName&apos;);</span><br><span class="line">        return $result;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// 为了获得一个起作用的数据访问对象子实体，至少需要定义两个受保护变量。</span><br><span class="line">// 要使用的数据访问对象的示例：</span><br><span class="line"></span><br><span class="line">define(&apos;DB_USER&apos;,&apos;user&apos;);</span><br><span class="line">define(&apos;DB_PASS&apos;,&apos;pass&apos;);</span><br><span class="line">define(&apos;DB_HOST&apos;,&apos;localhost&apos;);</span><br><span class="line">define(&apos;DB_DATABASE&apos;,&apos;test&apos;);</span><br><span class="line"></span><br><span class="line">$user = new userDAO();</span><br><span class="line">$userDetailsArray = $user-&gt;fetch(1);</span><br><span class="line"></span><br><span class="line">$updates = array(&apos;id&apos;=&gt;1,&apos;firstName&apos;=&gt;&apos;aaron&apos;);</span><br><span class="line">$user-&gt;update($updates);</span><br><span class="line"></span><br><span class="line">$allAarons = $user-&gt;getUserByFirstName(&apos;aaron&apos;);</span><br></pre></td></tr></table></figure>
<h3 id="装饰器模式"><a class="header-anchor" href="#装饰器模式"></a>装饰器模式</h3>
<blockquote>
<p>如果已有对象的部分内容或功能性发生改变，但是不需要修改原始对象的结构，那么使用装饰器设计模式最适合。</p>
</blockquote>
<p>装饰器设计模式适用于编程人员花费大量时间所处的下列工作场合：变化是快速和细小的，而且几乎不影响应用程序的其余部分。使用装饰器设计模式设计类的目的是：不必重写任何已有的功能性，而是对某个基对象应用增量变化。装饰器采用这样的构建方式：在主代码流中应当能够直接插入一个或多个更改或“装饰”目标对象的装饰器，同时不影响其他代码流。</p>
<h4 id="关系说明-v3"><a class="header-anchor" href="#关系说明-v3"></a>关系说明</h4>
<ol>
<li>MyObject是具有现有功能性的基类。这个类包含名为items的公共数组和名为show ItemsFormatted()的公共方法。</li>
<li>showItemsFormatted()方法负责接受items数组，并且使用预定义的功能性格式化该数组后提交输出。</li>
<li>MyObjectDecorator类包含MyObject 的一个私有实例和两个公共方法: MyoObjec-Decorator()和decorateItems()。</li>
<li>MyObjectDecorator()方法代表构造函数，它接受一个MyObject 类型参数并将其存储在内部。</li>
<li>decorate()方法可修改Myobject实例的items数组。</li>
</ol>
<h4 id="代码示例-v4"><a class="header-anchor" href="#代码示例-v4"></a>代码示例</h4>
<ol>
<li>
<p>《PHP设计模式》里面的一个案例</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line">// 被修饰类 现在的需求： 要求能够动态为CD添加音轨、能显示CD音轨列表。 显示时应采用单行并且为每个音轨都以音轨好为前缀。</span><br><span class="line"> </span><br><span class="line">class CD &#123;</span><br><span class="line">    public $trackList;</span><br><span class="line"> </span><br><span class="line">    function __construct()   &#123;</span><br><span class="line">        # code...</span><br><span class="line">        $this-&gt;trackList=array();</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    public function addTrack($track)&#123;</span><br><span class="line">        $this-&gt;trackList[]=$track;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    public function getTrackList()&#123;</span><br><span class="line">        $output=&quot; &quot;;</span><br><span class="line">        foreach ($this-&gt;trackList as $key =&gt; $value) &#123;</span><br><span class="line">            # code...</span><br><span class="line">            $output.=($key+1).&quot;) &#123;$value&#125;. &quot;;</span><br><span class="line">        &#125;</span><br><span class="line">        return $output;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// 现在需求发生变化： 要求将当前实例输出的音轨都采用大写形式。 这个需求并不是一个变化特别大的需求，不需要修改基类或创建一个父子关系的子类，此时创建一个基于装饰器模式的装饰器类。</span><br><span class="line"></span><br><span class="line">class CDTrackListDecoratorCaps&#123;</span><br><span class="line">    private $_cd;</span><br><span class="line"> </span><br><span class="line">    public function __construct(CD $CD)&#123;</span><br><span class="line">        $this-&gt;_cd=$CD;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public function makeCaps()&#123;</span><br><span class="line">        foreach ($this-&gt;_cd-&gt;trackList as $key =&gt; $value) &#123;</span><br><span class="line">            # code...</span><br><span class="line">            $this-&gt;_cd-&gt;trackList[$key]=strtoupper($value); //转换成大写</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">//客户端测试</span><br><span class="line">$myCD=new CD();</span><br><span class="line">$trackList=array(   &quot;what It Means&quot;,   &quot;brr&quot;,   &quot;goodBye&quot;  );</span><br><span class="line">foreach ($trackList as $key =&gt; $value) &#123;</span><br><span class="line">    # code...</span><br><span class="line">    $myCD-&gt;addTrack($value);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$myCDCaps=new CDTrackListDecoratorCaps($myCD);</span><br><span class="line">$myCDCaps-&gt;makeCaps();</span><br><span class="line">print &quot;The CD contains the following tracks:&quot;.$myCD-&gt;getTrackList();</span><br></pre></td></tr></table></figure>
</li>
<li>
<p>REST 服务提供 JSON 和 XML 装饰器</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br></pre></td><td class="code"><pre><span class="line">RendererInterface.php</span><br><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">namespace DesignPatterns\Structural\Decorator;</span><br><span class="line"></span><br><span class="line">interface RendererInterface</span><br><span class="line">&#123;</span><br><span class="line">    public function renderData();</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line">Webservice.php</span><br><span class="line">&lt;?php</span><br><span class="line"> </span><br><span class="line">namespace DesignPatterns\Structural\Decorator;</span><br><span class="line"></span><br><span class="line">class Webservice implements RendererInterface</span><br><span class="line">&#123;</span><br><span class="line">    protected $data;</span><br><span class="line"></span><br><span class="line">    public function __construct($data)</span><br><span class="line">    &#123;</span><br><span class="line">        $this-&gt;data = $data;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public function renderData()</span><br><span class="line">    &#123;</span><br><span class="line">        return $this-&gt;data;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line">Decorator.php</span><br><span class="line">&lt;?php</span><br><span class="line"> </span><br><span class="line">namespace DesignPatterns\Structural\Decorator;</span><br><span class="line"> </span><br><span class="line">/**</span><br><span class="line"> * 装饰器必须实现 RendererInterface 接口, 这是装饰器模式的主要特点，</span><br><span class="line"> * 否则的话就不是装饰器而只是个包裹类</span><br><span class="line"> */</span><br><span class="line">abstract class Decorator implements RendererInterface</span><br><span class="line">&#123;</span><br><span class="line">    protected $wrapped;</span><br><span class="line"> </span><br><span class="line">    /**</span><br><span class="line">     * 必须类型声明装饰组件以便在子类中可以调用renderData()方法</span><br><span class="line">     * @param RendererInterface $wrappable</span><br><span class="line">     */</span><br><span class="line">    public function __construct(RendererInterface $wrappable)</span><br><span class="line">    &#123;</span><br><span class="line">        $this-&gt;wrapped = $wrappable;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line">RenderInXml.php</span><br><span class="line">&lt;?php</span><br><span class="line"> </span><br><span class="line">namespace DesignPatterns\Structural\Decorator;</span><br><span class="line"></span><br><span class="line">class RenderInXml extends Decorator</span><br><span class="line">&#123;</span><br><span class="line">    public function renderData()</span><br><span class="line">    &#123;</span><br><span class="line">        $output = $this-&gt;wrapped-&gt;renderData();</span><br><span class="line"> </span><br><span class="line">        // do some fancy conversion to xml from array ...</span><br><span class="line"> </span><br><span class="line">        $doc = new \DOMDocument();</span><br><span class="line"> </span><br><span class="line">        foreach ($output as $key =&gt; $val) &#123;</span><br><span class="line">            $doc-&gt;appendChild($doc-&gt;createElement($key, $val));</span><br><span class="line">        &#125;</span><br><span class="line"> </span><br><span class="line">        return $doc-&gt;saveXML();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line">RenderInJson.php</span><br><span class="line">&lt;?php</span><br><span class="line"> </span><br><span class="line">namespace DesignPatterns\Structural\Decorator;</span><br><span class="line"></span><br><span class="line">class RenderInJson extends Decorator</span><br><span class="line">&#123;</span><br><span class="line">    public function renderData()</span><br><span class="line">    &#123;</span><br><span class="line">        $output = $this-&gt;wrapped-&gt;renderData();</span><br><span class="line">        return json_encode($output);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line">Tests/DecoratorTest.php</span><br><span class="line">&lt;?php</span><br><span class="line"> </span><br><span class="line">namespace DesignPatterns\Structural\Decorator\Tests;</span><br><span class="line"> </span><br><span class="line">use DesignPatterns\Structural\Decorator;</span><br><span class="line"> </span><br><span class="line">/**</span><br><span class="line"> * DecoratorTest 用于测试装饰器模式</span><br><span class="line"> */</span><br><span class="line">class DecoratorTest extends \PHPUnit_Framework_TestCase</span><br><span class="line">&#123;</span><br><span class="line"> </span><br><span class="line">    protected $service;</span><br><span class="line"> </span><br><span class="line">    protected function setUp()</span><br><span class="line">    &#123;</span><br><span class="line">        $this-&gt;service = new Decorator\Webservice(array(&apos;foo&apos; =&gt; &apos;bar&apos;));</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    public function testJsonDecorator()</span><br><span class="line">    &#123;</span><br><span class="line">        // Wrap service with a JSON decorator for renderers</span><br><span class="line">        $service = new Decorator\RenderInJson($this-&gt;service);</span><br><span class="line">        // Our Renderer will now output JSON instead of an array</span><br><span class="line">        $this-&gt;assertEquals(&apos;&#123;&quot;foo&quot;:&quot;bar&quot;&#125;&apos;, $service-&gt;renderData());</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    public function testXmlDecorator()</span><br><span class="line">    &#123;</span><br><span class="line">        // Wrap service with a XML decorator for renderers</span><br><span class="line">        $service = new Decorator\RenderInXml($this-&gt;service);</span><br><span class="line">        // Our Renderer will now output XML instead of an array</span><br><span class="line">        $xml = &apos;&lt;?xml version=&quot;1.0&quot;?&gt;&lt;foo&gt;bar&lt;/foo&gt;&apos;;</span><br><span class="line">        $this-&gt;assertXmlStringEqualsXmlString($xml, $service-&gt;renderData());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ol>
<h3 id="委托模式"><a class="header-anchor" href="#委托模式"></a>委托模式</h3>
<blockquote>
<p>通过分配或委托至其他对象，委托设计模式能够去除核心对象中的判断和复制的功能</p>
</blockquote>
<p>委托设计模式致力于从核心对象中去除复杂性。此时我们并不设计极大依赖于通过评估条件语句而执行特定功能性的对象，基于委托模式的对象能够将判决委托给不同的对象。</p>
<p>当一个对象包含复杂但独立的、必须基于判决执行的功能性的若干部分时，最佳的做法是使用基于委托设计模式的对象。</p>
<h4 id="关系说明-v4"><a class="header-anchor" href="#关系说明-v4"></a>关系说明</h4>
<ol>
<li>基类 Myobject 知道会使用基于委托设计模式的对象。这个类包含私有字符字符delegateType 以及 MydelegateObject 的私有实例 internalDelegate</li>
<li>setDelegateTyp() 方法接收一个名为type的参数，这个参数被存储在 delegateType字符串中。</li>
<li>createDelegateObject()方法会创建委托对象的一个实例，并且根据 delegateType变量为实例命名。随后，通过将该实例指派给 internalDelegate，这个方法将其存储在内部。</li>
<li>runDelegateAction() 方法负责运行 internalDetegate 对象的action()方法</li>
<li>MydelegateObject 包含负责特定动作的逻辑。MyObject 运行 action() 方法实现具体的功能。</li>
</ol>
<h4 id="代码示例-v5"><a class="header-anchor" href="#代码示例-v5"></a>代码示例</h4>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">newPlayList</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> $_songs;</span><br><span class="line">    <span class="keyword">private</span> $_typeObject;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span><span class="params">($type)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;_songs = [];</span><br><span class="line">        $object = <span class="string">"&#123;$type&#125;PlayListDelegate"</span>;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;_typeObject = <span class="keyword">new</span> $object;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">addSong</span><span class="params">($location, $title)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;_songs[] = [<span class="string">'location'</span> =&gt; $location, <span class="string">'title'</span> =&gt; $title];</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">getPlayList</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        $playList = <span class="keyword">$this</span>-&gt;_typeObject-&gt;getPlayList(<span class="keyword">$this</span>-&gt;_songs);</span><br><span class="line">        <span class="keyword">return</span> $playList;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">m3uPlayListDelegate</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">getPlayList</span><span class="params">($songs)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        $m3u = <span class="string">"#EXTM3U\n\n"</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">foreach</span> ($songs <span class="keyword">as</span> $song) &#123;</span><br><span class="line">            $m3u .= <span class="string">"#EXTINF:-1,&#123;$song['title']&#125;\n"</span>;</span><br><span class="line">            $m3u .= <span class="string">"&#123;$song['location']&#125;\n"</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> $m3u;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">plsPlayListDelegate</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">getPlayList</span><span class="params">($songs)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        $pls = <span class="string">"[playlist]\nNumberOfEntries="</span> . count($songs) . <span class="string">"\n\n"</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">foreach</span> ($songs <span class="keyword">as</span> $key =&gt; $song) &#123;</span><br><span class="line">            $counter = $key + <span class="number">1</span>;</span><br><span class="line">            $pls .= <span class="string">"File&#123;$counter&#125;=&#123;$song['location']&#125;\n"</span>;</span><br><span class="line">            $pls .= <span class="string">"Title&#123;$counter&#125;=&#123;$song['title']&#125;\n"</span>;</span><br><span class="line">            $pls .= <span class="string">"Length&#123;$counter&#125;=-1\n"</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> $pls;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$type = <span class="string">'pls'</span>;</span><br><span class="line">$playList = <span class="keyword">new</span> newPlayList($type);</span><br><span class="line">$content = $playList-&gt;getPlayList();</span><br></pre></td></tr></table></figure>
<h3 id="外观模式"><a class="header-anchor" href="#外观模式"></a>外观模式</h3>
<blockquote>
<p>通过在必需的逻辑和方法的集合前创建简单的外观接口，外观设计模式隐藏了来自调用对象的复杂性。</p>
</blockquote>
<p>外观设计模式的目标是：控制外部错综复杂的关系，并且提供简单的接口以利用上述组件的能力。外观设计模式的独特性在于被设计为将多个互相联系的组件组合或连接入简单可用的接口内。使用基于外观设计模式的对象另一个原因是接口第三方解决方案。</p>
<p>为了隐藏复杂的、执行业务进程某个步骤所需的方法和逻辑组，就应当使用基于外观设计模式的类。</p>
<h4 id="关系说明-v5"><a class="header-anchor" href="#关系说明-v5"></a>关系说明</h4>
<ol>
<li>
<p>MyObject类包含一个名为 doSomethingRequiresAandB() 的公共方法，该方法只是MyObject 类执行中的一个步骤。doSomethingRequiresAandB() 方法创建对象 LogicFacade 的一个新实例，该实例调用对于MyObject来说足够抽象的、名称为 callRequiredLogic() 的公共方法。</p>
</li>
<li>
<p>LogicFacade 类内部的 callRequiredLogic() 方法随后负责创建 LogicObjectA 的一个实例以及调用 doSomethingA() 方法，此外还负责创建 LogicObjectB 的一个实例以及调用 doSomethingB() 方法。</p>
</li>
<li>
<p>上述所有动作都通过LogicFacade类向回传递，从而使它们能够被 MyObject 使用。</p>
</li>
</ol>
<h4 id="代码示例-v6"><a class="header-anchor" href="#代码示例-v6"></a>代码示例</h4>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">CD</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> $tracks = [];</span><br><span class="line">    <span class="keyword">public</span> $band = <span class="string">''</span>;</span><br><span class="line">    <span class="keyword">public</span> $title = <span class="string">''</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span><span class="params">($title, $band, $tracks)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;title = $title;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;band = $band;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;tracks = $tracks;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">CDUpperCase</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="function"><span class="keyword">function</span> <span class="title">makeString</span><span class="params">(CD $cd, $type)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        $cd-&gt;$type = strtoupper($cd-&gt;$type);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="function"><span class="keyword">function</span> <span class="title">makeArray</span><span class="params">(CD $cd, $type)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        $cd-&gt;$type = array_map(<span class="string">'strtoupper'</span>, $cd-&gt;$type);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">CDMakeXML</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="function"><span class="keyword">function</span> <span class="title">create</span><span class="params">(CD $cd)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        $doc = <span class="keyword">new</span> DomDocument();</span><br><span class="line"></span><br><span class="line">        $root = $doc-&gt;createElement(<span class="string">'CD'</span>);</span><br><span class="line">        $root = $doc-&gt;appendChild($root);</span><br><span class="line"></span><br><span class="line">        $title = $doc-&gt;createElement(<span class="string">'TITLE'</span>, $cd-&gt;title);</span><br><span class="line">        $title = $root-&gt;appendChild($title);</span><br><span class="line"></span><br><span class="line">        $band = $doc-&gt;createElement(<span class="string">'BAND'</span>, $cd-&gt;title);</span><br><span class="line">        $band = $root-&gt;appendChild($band);</span><br><span class="line"></span><br><span class="line">        $tracks = $doc-&gt;createElement(<span class="string">'TRACKS'</span>, $cd-&gt;title);</span><br><span class="line">        $tracks = $root-&gt;appendChild($tracks);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">foreach</span> ($cd-&gt;tracks <span class="keyword">as</span> $t) &#123;</span><br><span class="line">            $track = $doc-&gt;createElement(<span class="string">'TRACK'</span>, $t);</span><br><span class="line">            $track = $tracks-&gt;appendChild($track);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> $doc-&gt;saveXML();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">WebServiceFacade</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="function"><span class="keyword">function</span> <span class="title">makeXMLCall</span><span class="params">(CD $cd)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        CDUpperCase::makeString($cd, <span class="string">'title'</span>);</span><br><span class="line">        CDUpperCase::makeString($cd, <span class="string">'band'</span>);</span><br><span class="line">        CDUpperCase::makeArray($cd, <span class="string">'tracks'</span>);</span><br><span class="line"></span><br><span class="line">        $xml = CDMakeXML::create($cd);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> $xml;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$cd = <span class="keyword">new</span> CD(<span class="string">'Waste of a Rib'</span>, <span class="string">'Never Again'</span>, [<span class="string">'Brrr'</span>, <span class="string">'Goodbye'</span>]);</span><br><span class="line"><span class="keyword">print</span> WebServiceFacade::makeXMLCall($cd);</span><br></pre></td></tr></table></figure>
<h3 id="工厂模式"><a class="header-anchor" href="#工厂模式"></a>工厂模式</h3>
<blockquote>
<p>工厂设计模式提供获取某个对象的新实例的一个接口，同时使调用代码避免确定实际实例化基类的步骤</p>
</blockquote>
<p>工厂设计模式可以实现不同对象的创建。另外，还可以处理若干项的集合，在这种情况下，对象集合包含相同的基对象，但是每个对象都具有不同的特征，库存系统是使用工厂类管理对象集合的一个优秀实例。</p>
<h4 id="关系说明-v6"><a class="header-anchor" href="#关系说明-v6"></a>关系说明</h4>
<ol>
<li>
<p>现存的两个基类是 MyobjectTypeA 和 MyobjectTypeB 这两个类都具有名为 doSome Thing() 的公共方法，该方法采用自己独特的方式执行具体对象的逻辑。两个基类的公共接口和返回类型是完全相同的。</p>
</li>
<li>
<p>MyobjectFactory 类用于创建上述任意一个基类的实例并将其返回至代码流。它具有一个名为 createObject() 的公共方法，该方法接受参数type，这有助于判断应当创建哪一个基类的实例。随后， createObject() 方法会返回被请求类型类的一个实例。</p>
</li>
</ol>
<h4 id="代码示例-v7"><a class="header-anchor" href="#代码示例-v7"></a>代码示例</h4>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">CDFactory</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="function"><span class="keyword">function</span> <span class="title">create</span><span class="params">($type)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        $class = strtolower($type) . <span class="string">"CD"</span>;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> $class;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$type = <span class="string">'enhanced'</span>;</span><br><span class="line">$cd = CDFactory::create($type);</span><br></pre></td></tr></table></figure>
<h3 id="解释器模式"><a class="header-anchor" href="#解释器模式"></a>解释器模式</h3>
<blockquote></blockquote>

        
    </section>
</article>



<div class="comments">
    <div id="comments"></div>
    <script src="https://unpkg.com/gitalk/dist/gitalk.min.js"></script>
    <script>
    new Gitalk({
        clientID: "6f5e8f287e18d0fe8720",
        clientSecret: "d951a19150cabd06c9e4fb2d72f0dc25132d0999",
        repo: "abcdkyd.github.io",
        owner: "abcdkyd",
        admin: ["abcdkyd"],
        id: "2018/12/29/php设计模式",
        distractionFreeMode: true,
        title: "php设计模式",
        body: "https://abcdkyd.github.io/2018/12/29/php设计模式/",
        labels: ["php"]
    }).render('comments');
    </script>
</div>

</div>
        <footer class="footer">
    Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>, Theme by <a href="https://github.com/sanonz/hexo-theme-concise" target="_blank">Concise</a>

    
</footer>

    </main>

    <script type="text/javascript" src="https://cdn.bootcss.com/jquery/1.9.0/jquery.min.js"></script>
    <script type="text/javascript">
    $(function() {
        var nodes = {
            nav: $('#nav'),
            aside: $('#aside'),
            asideInner: $('#aside-inner'),
            navInner: $('#nav-inner')
        };

        var doing = false;
        nodes.asideInner.on('webkitAnimationEnd mozAnimationEnd oAnimationEnd oanimationend animationend', function() {
            if (nodes.aside.hasClass('mobile-open')) {
                nodes.aside.removeClass('mobile-open');
            } else {
                nodes.aside.removeClass('mobile-close panel-show');
            }
            doing = false;
        });
        $('#open-panel, #aside-mask').on('click', function() {
            if (doing) {
                return;
            }
            
            if (nodes.aside.hasClass('panel-show')) {
                nodes.aside.addClass('mobile-close');
            } else {
                nodes.aside.addClass('mobile-open panel-show');
            }
        });
        $('#open-menus').on('click', function() {
            nodes.navInner.slideToggle();
        });

        if (window.innerWidth <= 960) {
            setTimeout(function() {
                nodes.navInner.slideUp();
            }, 3000);
        }
    });
    </script>
    
        <script type="text/javascript" src="/js/scrollspy.min.js"></script>
        <script type="text/javascript">
        $(document.body).scrollspy({target: '#aside-inner'});
        </script>
    

</body>
</html>
